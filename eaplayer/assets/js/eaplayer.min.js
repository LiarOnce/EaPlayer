function lcz(){var _this=this;this.geci_object,this.geci_lines,this.upkp,this.classV1,this.classV2,this.initTop,this.center,this.empty,this.isDropgeci,this.width,this.height,this.align,this.oneline,this.luminous,this.change,this.staue=!0,this.tag={},this.mould='<ul style="height: 184px;list-style: none;position: relative;line-height: 30px;padding: 0 15px;overflow-y: hidden;display:none;"></ul>',this.getgeci="Value";var errmsg="程序发生异常，无法继续了！";this.toTimer=function(e){var t,n;return t=Math.floor(e/60),t=isNaN(t)?"--":t>=10?t:"0"+t,n=Math.floor(e%60),n=isNaN(n)?"--":n>=10?n:"0"+n,t+":"+n},this.addgeci=function(e,t,n){var r=document.createElement("li");r.innerHTML=t?t:"",r.className=e?e:"",r.lang=n?n:"",this.geci_object.appendChild(r),this.geci_lines.push(r)},this.getgeciByValue=function(e){le=this.geci_lines.length,e="^"+e+".*";for(var t=0;t<le;t++){if(this.geci_lines[t].lang.search(e)==0){return this.geci_lines[t]}}return null},this.getgeciByValueInd=function(e){le=this.geci_lines.length-1;for(var t=le;t>=0;t--){p=this.geci_lines[t].lang;if(p&&p<e){return this.geci_lines[t]}}return null},this.setClassName=function(e,t){e&&(e.className=t)},this.upTop=function(e){var t=e.offsetTop,n=this.geci_object.scrollTop,r=t-this.center;this.myf(this.geci_object,n,r)},this.remove=function(){if(this.geci_lines!=null){for(var e=0;e<this.geci_lines.length;e++){this.geci_object.removeChild(this.geci_lines[e])}}this.geci_lines=new Array,!this.empty&&this.empty!=0&&alert("empty 属性有误! 该值必须>=零")},this.load=function(json,fun){gecis=json.gecis,end=json[this.tag.end];with(this){remove(),_addgeci(json[this.tag.sname]),_addgeci(json[this.tag.cname]),_addgeci(json[this.tag.qname]),_addgeci(json[this.tag.bname]),_addgeci(json[this.tag.sgname]),_addgeci(json[this.tag.special]),_addgeci(json[this.tag.kname])}if(gecis){for(var index in gecis){this.addgeci(this.classV1,gecis[index].name,gecis[index].time)}}end&&(end.time?this.addgeci(this.classV1,end.end,end.time):this.addgeci(this.classV1,end)),typeof fun=="function"&&fun.call(null,null)},this._addgeci=function(e){e&&(e.time?this.addgeci(this.classV1,e.name,e.time):this.addgeci(this.classV1,e))},this.Read=function(e,t){if(t!=null&&typeof t=="function"){return t.call(this,e)}var n={};n.gecis=new Array;var r=e.split("["),i=r.length;for(var s=0;s<i;s++){var o=r[s],u=o.split("]");if(u.length==2){if(u[0].search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0){title=u[0].split(":"),n=tagswitch(title,n)}else{var a={time:u[0],name:u[1]};n.gecis.push(a)}}}return n},this.vls1=function(e){var n={};n.gecis=new Array;var r=e.length,i=0,s=0,o=new Array;for(var u=0;u<r;u++){e[u]=="["&&u>8&&(e.slice(u-9,u-1)+"").search("^[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0&&(o.push(e.substring(i,u)),i=u)}o.push(e.substring(i,r));var a={},f=[];for(var u=0;u<o.length;u++){var l=o[u],c=l.split("]");if(c.length===2){(c[0]+"").search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")<0?(c[0]=c[0].slice(1),title=c[0].split(":"),n=tagswitch(title,n)):(h=c[0].slice(1)+"",a[h]=c[1],f.push(h))}else{if(c.length>2){var h,e;e=c[c.length-1];for(var p in c){c[p].search("^\\[[0-9]{2}:[0-9]{2}.[0-9]{1,3}$")==0&&(h=c[p].slice(1)+"",a[h]=e,f.push(h))}}}}f=f.sort();for(var p in f){t=f[p];var d={time:t,name:a[t]};n.gecis.push(d)}return n};var tagswitch=function(e,t){e.length===2&&(tp=e[1]),tag=_this.tag;switch(e[0]){case tag.sname:t[tag.sname]=tp;break;case tag.cname:t[tag.cname]=tp;break;case tag.qname:t[tag.qname]=tp;break;case tag.bname:t[tag.bname]=tp;break;case tag.sgname:t[tag.sgname]=tp;break;case tag.special:t[tag.special]=tp;break;case tag.kname:t[tag.kname]=tp;break;case tag.end:t[tag.end]=tp}return t};this.myf_Init=function(){this.geci_object.innerHTML=this.mould,asc=this.geci_object=this.geci_object.firstChild,asc.style.width=this.width,asc.style.height=this.height,asc.style.textAlign=this.align,this.oneline?(this.empty=0,this.center=5):(this.empty=5,this.center=this.geci_object.style.height/2|120),this.isDropgeci&&this.logon(!1)},this.setoccupy=function(e,t){e.style.display="block",this.setClassName(e,this.classV2),this.upTop(e),this.upkp&&this.unoccupy(this.upkp),this.upkp=e,t&&t(e)},this.unoccupy=function(e,t){this.setClassName(e,this.classV1),this.oneline&&(e.style.display="none"),t&&t(e)},this.torun=function(time){if(!this.staue){return !1}var time=this.toTimer(Math.round((time|event.srcElement.currentTime)*100)/100),line=eval("this.getgeciBy"+this.getgeci+"(time)");line&&this.upkp!=line&&this.setoccupy(line)},this.logon=function(e){if(window.FileReader){var t=this.geci_object;e&&(t=document.getElementById(e));function n(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;for(var n=0,r;r=t[n];n++){var i=new FileReader;i.onloadend=function(e){return function(e){img=e.target.result,img&&_this.load(_this.Read(img))}}(r),i.readAsText(r)}}function r(e){}function i(e){}function s(e){e.stopPropagation(),e.preventDefault()}t.addEventListener("dragenter",r,!1),t.addEventListener("dragover",s,!1),t.addEventListener("drop",n,!1),t.addEventListener("dragleave",i,!1),t.addEventListener("ondragend",i,!1)}else{alert("你的浏览器不支持啊，同学")}};var timer=null;this.myf=function(e,t,n){timer!=null&&clearTimeout(timer),this.isUpOrDown(e,t,n)},getUpValue=function(e,t){return t-e>100?e+=30:t-e>50?e+=10:t-e>20?e+=5:t-e>1&&e++,e},getDowmValue=function(e,t){return e-t>100?e-=30:e-t>50?e-=10:e-t>20?e-=5:e-t>1&&e--,e},this.isUpOrDown=function(e,t,n){t<n?this.toUp(e,t,n):this.toDown(e,t,n)},this.toUp=function(e,t,n){timer=setInterval(function(){t>=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getUpValue(t,n)},10)},this.toDown=function(e,t,n){timer=setInterval(function(){t<=n&&(clearTimeout(timer),timer=null,e.scrollTop=n),e.scrollTop=t,t=getDowmValue(t,n)},30)},this.destory=function(){}}geci={msg:{ms1:"元素位置没有给出！ error : 103",ms2:"请给出歌词的链接地址，或文本内容！ error : 105"},tag:{sname:"ti",cname:"cl",qname:"cs",bname:"ps",sgname:"ar",special:"al",kname:"by",end:"end"},build:function(e,d){var f=new lcz;return f.tag=geci.tag,e.object?f.geci_object=document.getElementById(e.object):alert(geci.msg.ms1),f.initTop=e.initTop!=null?e.initTop:0,f.center=e.center!=null?e.center:0,f.empty=e.empty!=null?e.empty:0,f.isDropgeci=e.isDropgeci!=null?e.isDropgeci:!0,f.getgeci=e.seekMark!=null?e.seekMark:"Value",d&&(f.classV1=d.notoccupy!=null?d.notoccupy:"geci_moonlight",f.classV2=d.occupy!=null?d.occupy:"geci_attention",f.width=d.width!=null?d.width:"550px",f.height=d.height!=null?d.height:"200px",f.align=d.align!=null?d.align:"left",f.oneline=d.oneline!=null?d.oneline:!1),f.myf_Init(),geci.readgeci(f,e.readType,{url:e.geciUrl?e.geciUrl:null,text:e.geciText?e.geciText:null},function(){f.geci_object.scrollTop=f.initTop,f.oneline&&(f.geci_object.className+=" geci_hide"),e.syntony&&e.syntony(f)})&&e.open&&geci.open(f),e.media&&(mp=document.getElementById(e.media),window.attachEvent?mp.attachEvent("ontimeupdate",function(){f.torun()}):mp.addEventListener("timeupdate",function(){f.torun()},!1)),f},readgeci:function(j,g,k,h){var e="";if(k.text){e=k.text}else{if(!k.url){return alert(geci.msg.ms2),!1}xmlhttp=null,window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:window.ActiveXObject&&(xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")),xmlhttp!=null&&(xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){return e=xmlhttp.responseText,e=e.replace(/<\/?.+?>/g,"").replace(/[\r\n]/g,""),j.load(j.Read(e,g),h),!0}$("#lrc_2 ul").append('<li style="color: #69d2e7;">暂无歌词</li>')}},xmlhttp.open("GET",k.url,!0),xmlhttp.send(null))}return j.load(j.Read(e,g),h),!0},open:function(b){b.geci_object&&(b.geci_object.style.display="block"),b.staue=!0},close:function(b){b.geci_object&&(b.geci_object.style.display="none"),b.staue=!1},suspend:function(b){b.geci_object&&(b.staue=!1)},destroy:function(b){geci.close(b),b.remove(b.geci_object)},setProgress:function(d,c){d.torun(c)}};(function(a){var X=a("#key"),Y=a(".play-list"),O=a("#audio"),P=a(".bg-player"),S=a(".cover-photo img"),W=a(".song-title"),V=a(".song-artist"),U=a(".album-name"),R=a(".btn-play i"),Q=a(".btn-download i");var v=0,u=0,e=O[0],K=localStorage.shuffle||"false";repeat=localStorage.repeat||0,continous=true,autoplay=true,trigger=false,timeout=false,time=new Date();var y,B,s,F,k,h;var x=X.data("api");if(X.attr("data-shuffle")=="true"){K=localStorage.shuffle="true"}else{K=localStorage.shuffle="false"}var H=function(ae,ag){var j=[];var af=JSON.parse(localStorage.getItem(ae));if(af){for(var ad=0;ad<af.length;ad++){if(ag==af[ad]){return}else{j=af}}}j.push(ag);localStorage.setItem(ae,JSON.stringify(j))};var m=function(ad){var j=JSON.parse(localStorage.getItem(ad));return j};var q=function(j,ae){var ad=","+j.join(",")+",";return ad.indexOf(","+ae+",")!=-1};var g=function(j){if(j===0){return"0B"}var ad=1024;sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];i=Math.floor(Math.log(j)/Math.log(ad));return(j/Math.pow(ad,i)).toPrecision(3)+sizes[i]};var b=function(j){var ad='<script type="text/javascript">'+j+"</script>";X.html(ad)};var n=function(ad){Y.html("");if(ad.length==0){Y.append("<li>没有找到歌曲</li>")}else{for(var ae=0;ae<ad.length;ae++){var af=ad[ae];var j=af.artist.name_2==null?"":" & "+af.artist.name_2;v=ae;v++;Y.append('<li><span class="li-title">'+v+". "+af.title+'</span> - <span class="li-artist">'+af.artist.name_1+j+"</span></li>")}}};var z=function(){y.each(function(ad){var j=ad;a(this).on("click",function(){k=j;A(k)})})};var c=function(j){n(playlist);y=a(".play-list li");z();if(j==0){A(k)}};var E=function(){e.play();R.attr("class","active ea-pause");timeout=setInterval(ab,500);s=true};var D=function(){e.pause();R.attr("class","ea-play");clearInterval(ab);s=false};var N=function(j){if(j<0){track=k=playlist.length-1}else{if(j>=playlist.length){track=k=0}else{track=j}}A(track)};var L=function(){var ad=new Date(),j=k;k=ad.getTime()%playlist.length;if(j==k){++k}N(k)};var l=function(){D();e.currentTime=0;F++;if(continous==true){s=true}if(repeat==1){E()}else{if(K==="true"){L()}else{if(repeat==2){N(++k)}else{if(k<playlist.length){N(++k)}}}}};var d=function(){if(s==true){E()}};var o=function(){if(X.attr("data-autoplay")=="true"&&window.innerWidth>769){setTimeout(function(){e.addEventListener("canplay",E(),false)},3000)}};var I=function(ai){var ad=parseInt(ai%60)<10?"0"+parseInt(ai%60):parseInt(ai%60),af=ai/e.duration*100;var j=e.duration;var ah;if(!j){ah="loading..."}else{var ae=parseInt(j/60);var ag=parseInt(j%60);ae=ae>=10?ae:"0"+ae;ag=ag>=10?ag:"0"+ag;ah="0"+parseInt(ai/60)+":"+ad+"/"+ae+":"+ag}a(".progress-sider .sider-pace").css("width",af+"%");a(".progress-sider a").css("left",af+"%");a(".player-timer").html(ah)};var f=function(){var j=this.seekable&&this.seekable.length?this.seekable.end(0):0;a(".progress-sider .sider-loaded").css("width",(100/(this.duration||1)*j)+"%")};var ab=function(){I(e.currentTime)};a(".progress-sider").slider({step:0.1,slide:function(j,ad){a(this).addClass("enable");I(e.duration*ad.value/100);clearInterval(timeout)},stop:function(j,ad){e.currentTime=e.duration*ad.value/100;a(this).removeClass("enable");timeout=setInterval(ab,500)}});var J=function(j){e.volume=localStorage.volume=j;a(".volume-sider .sider-pace").css("width",j*100+"%");a(".volume-sider a").css("left",j*100+"%")};var ac=localStorage.volume||0.5;a(".volume-sider").slider({max:1,min:0,step:0.01,value:ac,slide:function(j,ad){J(ad.value);a(this).addClass("enable");a(".volume .volume-mute").removeClass("enable")},stop:function(){a(this).removeClass("enable")}}).children(".volume-sider .sider-pace").css("width",ac*100+"%");a(".volume-mute i").click(function(){if(a(this).hasClass("enable")){J(a(this).data("volume"));a(this).removeClass("enable ea-mute").addClass("ea-volume")}else{a(this).data("volume",e.volume).removeClass("ea-volume").addClass("enable ea-mute");J(0)}});var r=0;var A=function(ad){var ae=playlist[ad];var j=ae.artist.name_2==null?"":" / "+ae.artist.name_2;var af=x+"/api.php?action=lyric&id="+ae.tid+"&source="+ae.source;a.getJSON(x+"/api.php?action=cover&id="+ae.pid+"&source="+ae.source,function(ag){S.attr("src",ag.url);P.css("background-image","url("+ag.url+")")});W.html(ae.title);V.html(" - "+ae.artist.name_1+j);U.html(ae.album);y.removeClass("playing").eq(ad).addClass("playing");a(".lyric-script").html('<script>geci.build({object:"lrc_2",media:"audio",geciUrl:"'+af+'",readType:"vls1",open:true},{oneline:false,height:"350px",width:"auto"});</script>');a.getJSON(x+"/api.php?action=song&id="+ae.mid+"&source="+ae.source,function(ag){if(ag.url==""){r++;if(r==v){r=0;U.html("该歌单包含收费歌曲无法播放，已自动跳过 "+v+" 首单曲，请联系网站管理员更换歌单。")}else{N(++k)}}else{O.attr("src",ag.url);e.volume=a(".volume-mute i").hasClass("enable")?0:ac;e.addEventListener("progress",f,false);e.addEventListener("durationchange",f,false);e.addEventListener("ended",l,false);e.addEventListener("canplay",d,false);Q.attr("title",g(ag.size))}});u=ad};var C=function(j,ad,ae){a.ajax({type:"GET",url:x+"/api.php",data:{action:"list",id:j,source:ad,type:ae},beforeSend:function(){Y.html("<li>正在加载数据...</li>")},success:function(af){b(af);k=K==="true"?time.getTime()%playlist.length:0;c(0);B=af;o()}});return};var G=function(j,ad){a.ajax({type:"GET",url:x+"/api.php",data:{action:"search",name:j,source:ad},beforeSend:function(){Y.html("<li>正在加载数据...</li>")},success:function(ae){b(ae);k=K==="true"?time.getTime()%playlist.length:0;c(1)}})};a(".music-search-form").bind("submit",function(j){j.preventDefault();var ae=X.attr("data-search");var ad=a(".music-search-form .music-search-input").val();G(ad,ae)});a(".btn-play i").on("click",function(){if(R.hasClass("active")){D()}else{E()}});a(".btn-prev i").on("click",function(){if(K==="true"){L()}else{N(--k)}});a(".btn-next i").on("click",function(){if(K==="true"){L()}else{N(++k)}});if(K=="true"){a(".btn-mode i").attr("class","ea-shuffle")}else{if(repeat==1){a(".btn-mode i").attr("class","ea-onec")}else{if(repeat==2){a(".btn-mode i").attr("class","ea-all")}}}a(".btn-mode i").on("click",function(){if(a(this).hasClass("ea-all")){K=localStorage.shuffle="true";repeat=localStorage.repeat=2;a(this).removeClass("ea-all").addClass("ea-shuffle")}else{if(a(this).hasClass("ea-shuffle")){K=localStorage.shuffle="false";repeat=localStorage.repeat=1;a(this).removeClass("ea-shuffle").addClass("ea-onec")}else{if(a(this).hasClass("ea-onec")){K=localStorage.shuffle="false";repeat=localStorage.repeat=2;a(this).removeClass("ea-onec").addClass("ea-all")}}}});a(".btn-download i").on("click",function(ad){var ae=document.createElement("iframe"),af=playlist[u],j=af.artist.name_2==null?"":"，"+af.artist.name_2;ae.style.display="none";ae.src=x+"/dl.php?id="+af.mid+"&source="+af.source+"&name="+af.artist.name_1+j+" - "+af.title;document.body.appendChild(ae);setTimeout(function(){document.body.removeChild(ae)},3000)});a(".btn-enlarge i").on("click",function(j){if(a(this).hasClass("enable")){a(".player-hide-box").css("height","0px");a(this).removeClass("enable")}else{if(window.innerWidth>769){a(".player-hide-box").css("height","400px")}else{a(".player-hide-box").css("height","296px")}a(this).addClass("enable")}});a(".btn-eaplayer").on("click",function(j){if(a(this).hasClass("enable")){if(window.innerWidth>769){a(".player-layer").css("left","-97%")}else{a(".player-layer").css("left","-94%")}a(this).removeClass("enable");a(".btn-eaplayer i").removeClass("ea-left").addClass("ea-right");if(a(".btn-enlarge i").hasClass("enable")){a(".player-hide-box").css("height","0px");a(".btn-enlarge i").removeClass("enable")}}else{a(".player-layer").css("left","0");a(this).addClass("enable");a(".btn-eaplayer i").removeClass("ea-right").addClass("ea-left")}});a(".empty-history").on("click",function(j){localStorage.removeItem("historyList");a(".history-list .temp-history").remove()});a(document).on("click","#eaplayer-button",function(){var ad=a(this).data("id"),ae=a(this).data("source"),ah=a(this).data("type"),ag=a(this).data("title");var j='{"id":"'+ad+'","source":"'+ae+'","type":'+ah+',"title":"'+ag+'"}';H("historyList",j);var af=[];a(".history-list li").each(function(ai){var aj=a(this).attr("data-id");var ak=a(this).attr("data-type");af[ai]=aj});if(q(af,ad)){a(".history-list li").removeClass("now");a(".history-list li").each(function(ai){if(a(this).attr("data-id")==ad){a(this).addClass("now")}});C(ad,ae,ah)}else{a(".history-list li").removeClass("now");a(".history-list").append('<li class="temp-history now" data-id="'+ad+'" data-source="'+ae+'" data-type="'+ah+'">'+ag+"</li>");C(ad,ae,ah)}});a(document).on("click",".history-list li",function(){a(".history-list li").removeClass("now");a(this).addClass("now");C(a(this).data("id"),a(this).data("source"),a(this).data("type"))});var T=X.attr("data-id");var Z=X.attr("data-source");var aa=X.attr("data-type");a(".history-list").append('<li class="now" data-id="'+T+'" data-source="'+Z+'" data-type="'+aa+'">「Welcome」默认的曲单</li>');C(T,Z,aa);var M=m("historyList");if(M){for(i=0;i<M.length;i++){var w=JSON.parse(M[i]);a(".history-list").append('<li class="temp-history" data-id="'+w.id+'" data-source="'+w.source+'" data-type="'+w.type+'">'+w.title+"</li>")}}console.log("%c 蜜汁路易 %c","background:#24272A; color:#ffffff","","https://www.cssplus.org");})(jQuery);